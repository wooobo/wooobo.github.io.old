---
title: "λ„λ€μ²΄ Ioc?"  
layout: archive  
date: 2023-05-16
---

# 1. IoC(Inversion of Control)λ€?

μμ΅΄μ„± κ΄€λ¦¬λ¥Ό μ™Έλ¶€μ— `μ„μ„`ν•μ—¬ κ°μ²΄μ μƒμ„±κ³Ό κ΄€λ¦¬λ¥Ό μ μ–΄ν•λ” κ°λ° ν¨ν„΄

# 2. λ„κ°€? μ™?
1. λ„κµ¬ν•ν… μ„μ„ν•λ”κ°€?
μ£Όλ΅ ν”„λ μ„ μ›ν¬μ— μ„μ„ν•©λ‹λ‹¤. λ€ν‘μ μΌλ΅ Spring ν”„λ΅λ μ„μ›ν¬λΌκ³  λ³Ό μ μκ² μµλ‹λ‹¤.

2. μ™ μ„μ„ν•λ”κ°€?
κ°μΈμ μΌλ΅ μƒκ°ν•λ” μ„μ„ν•λ” μ£Όμ” μ¥μ μ¤‘ ν•λ‚λ” κ°λ°μκ°€ λΉ„μ¦λ‹μ¤ λ΅μ§μ— μ§‘μ¤‘ν•  μ μλ‹¤λ” κ²ƒμ…λ‹λ‹¤.

κ·Έλ ‡λ‹¤λ©΄, `μμ΅΄μ„±μ„ ν”„λ μ„μ›ν¬μ— μ„μ„ν•κ³  κ°λ°μλ” λΉ„μ¦λ‹μ¤ λ΅μ§ κ°λ°μ— μ§‘μ¤‘ ν•  μ μλ‹¤.` μ •λ„λ΅ λ³΄λ©΄ λκ² λ„¤μ”.

# 3. μμ‹

[DI](/DI/)μ—μ„ ν™μ©ν–λ μ½”λ“λ¥Ό μ‚¬μ©ν•΄μ„ νƒκµ¬ν•΄λ³΄κ² μµλ‹λ‹¤.

μΌλ°μ μΌλ΅ κ°λ°μκ°€ κ°μ²΄λ¥Ό μƒμ„±κ΄€λ¦¬ ν•λ‹¤λ©΄ λ‹¤μκ³Ό κ°™μ„ κ²ƒμ…λ‹λ‹¤.
```java
LottoService lottoService = new LottoService(new RandomNumberGenerator());
```

κ·Έλ ‡λ‹¤λ©΄, κ°μ²΄μƒμ„±μ„ ν”„λ μ„μ›ν¬μ— μ„μ„ν•λ‹¤κ³  ν•λ”λ° κ·Έλ¬ν• ν¨ν„΄μ„ μ½”λ“λ΅ μ°μ„  λ³΄κ² μµλ‹λ‹¤.

```java
@SpringBootApplication
public class DemoApplication {

    public static void main(String[] args) {
        ApplicationContext context = SpringApplication.run(DemoApplication.class, args);

        LottoService myService = context.getBean(LottoService.class);
```

`ApplicationContext`λ€ κ°μ²΄μ—κ² `LottoService.classνƒ€μ…`μ `Bean`μ„ λ‹¬λΌκ³  ν•λ„¤μ” π¤”
κ·Έλ°λ° μ—¬κΈ°μ„ μ¤‘μ”ν• λ¶€λ¶„μ€ ν™•μ‹¤ν•κ² `new`λ¥Ό μ‚¬μ©ν•μ§€ μ•μ€κ²ƒμΌλ΅ λ΄μ„λ” κ°μ²΄ μƒμ„±μ„ ν”„λ μ„μ›ν¬μ— μ„μ„ν• κ²ƒμΌλ΅ λ³Ό μ μμµλ‹λ‹¤.

π«κ·Έλ°λ° μ‹¤ν–‰ν–λ”λ‹  
`Exception in thread "main" org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'com.example.demo.LottoService' available` μ—λ¬κ°€ λ°μƒν•λ„¤μ” π¤”  

Spring μ λ§λ²•μ„ λ³΄κΈ°μ„ν•΄μ„ λ¬΄μ–Έκ°€ μ„¤μ •μ΄ λ” ν•„μ”ν•κ°€ λ΄…λ‹λ‹¤. π‚
μƒκ°ν•΄λ³΄λ‹ κ·Έλ΄ μ μμ„κ²ƒ κ°™μ•„μ”.  
μ™λƒλ©΄ λ¬΄μ—‡μ„ `Bean`μΌλ΅ κ΄€λ¦¬ν•΄μ¤λΌκ³  μ„¤μ •ν•μ§€ μ•μ•κ±°λ“ μ”. 

`Bean`λ“±λ΅ λ°©λ²•μ€ μ—„μ²­ κ°„λ‹¨ν•©λ‹λ‹¤!  
`XML`,`Java Config`, `Component Scan` μ΄λ ‡κ² `Bean`μ„ λ“±λ΅ν•λ” λ°©λ²•μ΄ μλ”λ°μ”. μ΄λ²μ—λ” λ§μ΄ μ‚¬μ©ν•λ” `Component Scan` λ°©μ‹μ„ μ‚¬μ©ν•΄λ³΄κ² μµλ‹λ‹¤.

`@Service` μ–΄λ…Έν…μ΄μ…μ΄λ€ κ²ƒλ§ λ¶™μ—¬μ£Όλ©΄ λ©λ‹λ‹¤. κ·Έλ¬λ©΄ `Bean`μΌλ΅ λ“±λ΅ν•΄μ¤λ‹λ‹¤.

```java
@Service
public class LottoService {
    private final NumberGenerator numberGenerator;

    public LottoService(NumberGenerator numberGenerator) {
        this.numberGenerator = numberGenerator;
    }
}
```

λ‹¤μ‹ μ‹¤ν–‰ν•΄λ³΄κ² μµλ‹λ‹¤.  

`Parameter 0 of constructor in com.example.demo.LottoService required a bean of type 'com.example.demo.NumberGenerator' that could not be found.` μ—λ¬κ°€ λ°μƒν•λ„¤μ” π¤” 

`LottoService` μƒμ„±μμ 0λ²μ§Έ νλΌλ―Έν„°(`NumberGenerator`)λ¥Ό `Bean`μ—μ„ μ°Ύμ„ μ κ°€ μ—†λ°μ” π±   
`Bean`μΌλ΅ κ΄€λ¦¬ν•λ” κ°μ²΄λΌλ©΄ λ‹Ήμ—°ν μƒμ„±μ μ£Όμ…ν•΄μ•Όν•λ” κ°μ²΄ λν• `Bean`μ—μ„ μ°Ύμ„μ μμ–΄μ•Ό ν•  κ²ƒκ°™λ„¤μ” π‚  

κ·ΈλΌ `NumberGenerator`λ„ `Bean`μΌλ΅ λ“±λ΅ν•΄μ£Όλ©΄ λ©λ‹λ‹¤.  
`@Component` μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ—¬μ£Όλ©΄ λ©λ‹λ‹¤. κ·Έλ¬λ©΄ `Bean`μΌλ΅ λ“±λ΅ν•΄μ¤λ‹λ‹¤.

```java
@Component
public class RandomNumberGenerator implements NumberGenerator {

    public RandomNumberGenerator() {
    }

    @Override
    public int generate() {
        Random random = new Random();
        return random.nextInt(45) + 1;
    }
}
```

λ“λ””μ–΄ μ¥μƒμ‘λ™ λλ„¤μ”.  

```
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v3.0.6)

2023-05-17T17:10:59.007+09:00  INFO 73775 --- [           main] com.example.demo.DemoApplication         : Starting DemoApplication using Java 17.0.6 with PID 73775
2023-05-17T17:10:59.008+09:00  INFO 73775 --- [           main] com.example.demo.DemoApplication         : No active profile set, falling back to 1 default profile: "default"
2023-05-17T17:10:59.167+09:00  INFO 73775 --- [           main] com.example.demo.DemoApplication         : Started DemoApplication in 0.267 seconds (process running for 0.447)
LottoNumber{value=41}
```

## @Component, @Service... ??
`@Component, @Service, @Repository, @Controller` λ“±μ μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ—¬ BeanμΌλ΅ λ“±λ΅ν•  ν΄λμ¤μ— μ§€μ • ν•  μ μμµλ‹λ‹¤.  
μ¤ν”„λ§ λ¶€νΈλ” κΈ°λ³Έμ μΌλ΅ ν΄λμ¤ν¨μ¤λ¥Ό μ¤μΊ”ν•μ—¬ μ–΄λ…Έν…μ΄μ…μ΄ μ§€μ •λ ν΄λμ¤λ¥Ό μλ™μΌλ΅ BeanμΌλ΅ λ“±λ΅ν•©λ‹λ‹¤.  

μ΄μ™€ κ°™μ€ λ°©λ²•μ„ μ‚¬μ©ν•μ—¬ Beanμ„ λ“±λ΅ν•λ©΄ Spring IoC μ»¨ν…μ΄λ„κ°€ ν•΄λ‹Ή Beanμ„ μΈμ‹ν•κ³  ν•„μ”ν• κ³³μ—μ„ μ£Όμ…ν•  μ μμµλ‹λ‹¤.

# π¤”κ·Έλ°λ° `NumberGenerator` κµ¬ν„μ²΄κ°€ μ—¬λ¬κ°λ©΄ λ¬΄μ—‡μ„ μ£Όμ…ν• μ§€ μ–΄λ–»κ² μ •ν• κΉ?  

`@Primary` μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ©΄ λ©λ‹λ‹¤.  
`@Primary` μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ©΄ μ—¬λ¬κ°μ Bean μ¤‘μ—μ„ μ°μ„ μ μΌλ΅ μ£Όμ…ν•  Beanμ„ μ§€μ •ν•  μ μμµλ‹λ‹¤.

```java
@Component
@Primary
public class RandomNumberGenerator implements NumberGenerator {

    public RandomNumberGenerator() {
    }

    @Override
    public int generate() {
        Random random = new Random();
        return random.nextInt(45) + 1;
    }
}
```

ν•μ§€λ§ μ΄λ ‡κ² μ‚¬μ©ν•λ©΄ `NumberGenerator`λ¥Ό μ£Όμ…λ°›λ” λ¨λ“  κ³³μ—μ„ `RandomNumberGenerator`κ°€ μ£Όμ…λ©λ‹λ‹¤.
@Qualifier μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ©΄ μ£Όμ…ν•  Beanμ„ μ§€μ •ν•  μ μμµλ‹λ‹¤.

```java
public LottoService(@Qualifier("manualNumberGenerator") NumberGenerator numberGenerator) {
    this.numberGenerator = numberGenerator;
}
```
&nbsp;

# π§μ–΄λ…Έν…μ΄μ…???

`@Service` μ΄λ°κ²ƒμ„ ν΄λμ¤λ‚ λ©”μ†λ“ μ„μ— λ¶™μ΄λ” κ²ƒμ„ λ§ν•©λ‹λ‹¤.  
μ‰½κ² λ§ν•΄ μ£Όμ„μ…λ‹λ‹¤. ν•μ§€λ§ μΆ€ λ” μλ―Έμλ” μ£Όμ„μ΄λΌκ³  λ³΄λ©΄ λ©λ‹λ‹¤.  
ν”„λ μ„μ›ν¬λ‹¨μ—μ„ `@Service`μ΄κ² λ¶™μ–΄ μμΌλ©΄ μ•„ μ΄κ±΄ μ΄λ° κΈ°λ¥μ„ ν•λ” ν΄λμ¤ νΉμ€ λ©”μ†λ“κµ¬λ‚ μΈμ‹ν•λ„λ΅ μ£Όμ„μ„ λ‹¬μ•„ λ†“μ•λ‹¤κ³  λ³΄λ©΄ λ©λ‹λ‹¤.

> μ–΄λ…Έν…μ΄μ…μ€ λ°νƒ€μ„μ— λ¦¬ν”λ ‰μ…μ„ ν†µν•΄ μ½μ–΄λ“¤μΌ μλ„ μμΌλ©°, ν”„λ μ„μ›ν¬λ‚ λΌμ΄λΈλ¬λ¦¬μ—μ„ νΉμ • κΈ°λ¥μ„ ν™μ„±ν™”ν•κ±°λ‚ μ„¤μ •ν•  λ• μ‚¬μ©λ  μλ„ μμµλ‹λ‹¤.